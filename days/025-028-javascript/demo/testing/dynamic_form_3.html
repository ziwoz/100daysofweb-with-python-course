<html>

<head>
    <title>Dynamic Testing</title>
    <script type="text/javascript" src="jquery-3.3.1.min.js"></script>
</head>

<body>


    <form class="form-horizontal" method="post">
        <div class="form-group">
            <label style="text-align: left; width:15%" class="control-label col-sm-2" for="name">
                <h1>Class Name:</h1>
            </label>
            <div class="col-sm-10">
                <input type="text" class="form-control" name="class_name" id="class_name" placeholder="Class Name"
                    required>
            </div>
        </div>

        <div id="profile_parent" class="profile_parent">
            <h1>Profiles</h1>

            <div>
                <button type="button" id="prof_add_button">Add New</button>
            </div>

            <div class="profile_child" id="profile_child" style="padding-bottom: 15px; padding-top: 15px;">
                <label style="text-align: left; width:15%" class="control-label col-sm-2" for="profile_name">Profile
                    Name</label>

                <div class="form-control" id="profile_grand_child" class="profile_grand_child">

                    <div class="col-sm-10">
                        <input type="text" class="form-control" name="profile_name" id="profile_name"
                            placeholder="Profile_name" required>
                    </div>

                    <div>
                        <button type="button" id="prof_value_add">Add Value</button>
                    </div>

                    <label style="text-align: left; width:15%" class="control-label col-sm-2"
                        for="profile_value">Profile Value</label>
                    <div class="col-sm-10" id="profile_value">
                        <input type="text" class="form-control" name="profile_value" id="profile_value"
                            placeholder="Profile_value" required>
                    </div>

                </div>
            </div>
        </div>


        <div class="attribute_parent">
            <h1>Attributes</h1>
            <button type="button" id="attribute_add">Add Attr</button>
            <div class="attribute_child" id="attribute_child" style="margin-top: 15px; margin-bottom: 15px">
                <div>
                    <label style="text-align: left; width:15%"
                        for="attribute_name">Attribute Name</label>
                    <input style="text-align: left; width:15%" type="text" name="attribute_name"
                        class="attribute_name" placeholder="attribute name" value="testing">
                </div>
                <div>
                    <label style="text-align: left; width:15%" class="control-label col-sm-2"
                        for="attribute_type">Attribute Type</label>
                    <select class="form-control" id="cli" name="cli">
                        <option value="text">text</option>
                        <option value="number">number</option>
                        <option value='dropdown'>dropdown</option>
                        <option value='date'>date</option>
                        <option value='date'>time</option>
                        <option value='date'>datetime</option>
                    </select>
                </div>
                <div>
                    <label style="text-align: left; width:15%" class="control-label col-sm-2"
                        for="attribute_type">Default Value</label>
                    <input style="text-align: left; width:15%" type="text" class="form-control" name="attribute_default"
                        class="attributes_default" placeholder="default value">
                </div>
                <div>
                        <label style="text-align: left; width:15%" class="control-label" for="rest_api">display</label>
    
                        <input type="checkbox" name='display' value='display'>
    
                    </div>
            </div>
        </div>



<button type="submit" id='class_builder_submit'>submit Form</button>


    </form>



</body>
<script type="text/javascript">



    $('#add_me').click(function () {
        var row = $(".ssh_rest").eq(0).clone().find("input[type='text']").val("").end();
        $("#parent").append(row);
    });

    $('btn-remove-row').click(function () {
        var index = $(".btn-remove-row").index(this);
        $(".form-control-1").eq(index).remove();
    });

    $('#prof_add_button').click(function () {
        console.log('the button is pressed');
        var profile_box = $('#profile_child').clone(true).find("input[type='text']").val("").end();
        $('#profile_parent').append(profile_box);

    });

    $('#prof_value_add').click(function () {
        console.log('going for a new value entry here');
        // var profile_index = $('#prof_value_add').index(this);
        var profile_value_box = $('#profile_value').clone().find("input[type='text']").val("").end();
        var this_elem = $(this);
        // var my_parent = this_elem.parent().parent().attr('id');


        // var my_parent = this_elem.parent().parent();
        // var my_grand_parent = this_elem.parent().parent().parent();
        // var my_index = my_parent.index(my_grand_parent);

        // the_index = $(this).parent().parent().parent().prevAll().length;
        the_index = $(this).parent().parent().parent().prevAll().length;

        // all_profiles = document.getElementsByClassName("profile_grand_child");
        all_profiles = document.getElementsByClassName("profile_child");

        // for(profiles of all_profiles){
        //     console.log(profiles);
        //     console.log(all_profiles.item(1));
        // };


        // the_index = $(this).parent().parent().parent().parent().parent().attr('class');

        console.log('the index for this profile is ' + the_index);
        $('.profile_child').eq(the_index - 2).append(profile_value_box);
        // $('.profile_child').eq(3).remove();
    });


    $('#attribute_add').click(function () {
        console.log('attribute add pressed');
        var attribute_box = $('#attribute_child').clone();
        $('.attribute_parent').append(attribute_box);

    });

    $('#class_builder_submit').click(function(){
        console.log('form is submitted');
        var all_attributes = document.getElementsByClassName('attribute_child');
        for(attribute of all_attributes){
            // attribute_name = attribute.getElementsByClassName('attribute_name');
            // var attribute_name = attribute.class;
            var inputs = attribute.getElementsByClassName('attribute_name');

// the following worked and got the input dont touch it
            // console.log(inputs[0].value)

            console.log(inputs)

        };

    });




</script>

</html>